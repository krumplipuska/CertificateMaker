#lasso { position: fixed; border:1px dashed #888; background: rgba(128,128,128,0.12); pointer-events: none; z-index: 99999; }

/* Selection group box */
.selbox { position:fixed; border:1px dashed rgba(124,58,237,.45); border-radius:6px; pointer-events:none; z-index: 800; background: transparent; }
.selbox.hidden { display:none; }
.selbox .sb-h { position:absolute; width:10px; height:10px; border-radius:50%; background:#fff; border:2px solid #7c3aed; box-shadow:0 1px 2px rgba(0,0,0,.1); pointer-events:auto; }
.selbox .sb-h[data-handle="nw"]{ left:-6px; top:-6px; }
.selbox .sb-h[data-handle="n"]{ left:50%; top:-6px; transform:translateX(-50%); }
.selbox .sb-h[data-handle="ne"]{ right:-6px; top:-6px; }
.selbox .sb-h[data-handle="e"]{ right:-6px; top:50%; transform:translateY(-50%); }
.selbox .sb-h[data-handle="se"]{ right:-6px; bottom:-6px; }
.selbox .sb-h[data-handle="s"]{ left:50%; bottom:-6px; transform:translateX(-50%); }
.selbox .sb-h[data-handle="sw"]{ left:-6px; bottom:-6px; }
.selbox .sb-h[data-handle="w"]{ left:-6px; top:50%; transform:translateY(-50%); }
/* Move and rotate handles */
.selbox .sb-h[data-handle="rotate"]{ right:50%; bottom:-24px; transform:translate(50%,50%); width:12px; height:12px; border-radius:50%; border-color:#3b82f6; cursor: grab; }
/* Move handle moved down next to rotation handle (offset to the right) */
.selbox .sb-h[data-handle="move"]{ left:calc(50% + 20px); bottom:-24px; transform:translate(-50%,50%); width:12px; height:12px; border-radius:4px; border-color:#10b981; cursor: grab; }
.selbox .sb-h[data-handle="move"]::after{ content:""; position:absolute; inset:2px; background:#10b981; border-radius:2px; }
.selbox .sb-h[data-handle="rotate"]::after{ content:""; position:absolute; inset:2px; border-radius:50%; background:#3b82f6; }
/* Resize cursors for handles */
.selbox .sb-h[data-handle="n"], .selbox .sb-h[data-handle="s"] { cursor: ns-resize; }
.selbox .sb-h[data-handle="e"], .selbox .sb-h[data-handle="w"] { cursor: ew-resize; }
.selbox .sb-h[data-handle="ne"], .selbox .sb-h[data-handle="sw"] { cursor: nesw-resize; }
.selbox .sb-h[data-handle="nw"], .selbox .sb-h[data-handle="se"] { cursor: nwse-resize; }
/* Layout & theme for refactored editor */
:root{
  /* Use real-world millimeter dimensions so exports map directly to A4 */
  --page-w: 210mm;  /* A4 width */
  --page-h: 297mm;  /* A4 height */
  /* MonTech brand */
  --brand-primary: #E10600;
  --brand-dark: #222222;
  --brand-light: #F5F5F5;
  --brand-white: #FFFFFF;
  /* App theme mapped to brand */
  --bg: var(--brand-light);
  --panel: var(--brand-white);
  --ink: var(--brand-dark);
  --muted: #6b6b6b;
  --primary: var(--brand-primary);
  --border: #e5e5e5;
  --shadow: 0 2px 8px rgba(0,0,0,.06), 0 10px 20px rgba(0,0,0,.04);
  --zoom: 1;
  /* Panel dimensions */
  --left-panel-width: 200px;
  --right-panel-width: 240px;
  accent-color: var(--primary);
}
html, body { margin: 0; height: 100%; background: var(--bg); color: var(--ink);
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial; }

/* Top bar */
.topbar { position: fixed; inset: 0 0 auto 0; height: 44px; background: var(--brand-primary); color: var(--brand-white); display: flex; align-items: center; gap: 6px; padding: 0 10px; box-shadow: var(--shadow); z-index: 1100; }
/* Make groups transparent for a cleaner bar */
.topbar .group { display: inline-flex; gap: 6px; border: 0; border-radius: 999px; padding: 0; background: transparent; }
/* Simple, outlined white pills inside the red bar */
.topbar .btn { background: transparent; color: #fff; border-color: rgba(255,255,255,.9); border-radius: 999px; transition: background-color .15s ease, color .15s ease, border-color .15s ease, transform .15s ease; }
/* Prominent hover/focus: white pill, brand text/icon */
.topbar .btn:hover,
.topbar .btn:focus-visible { background: #fff; color: var(--brand-primary); border-color: #fff; transform: translateY(-1px); }
/* Icons follow text color so hover/focus recolors them too */
.topbar > .group .btn .icon { color: currentColor; }
.topbar > .group .btn .icon circle { fill: currentColor; }
.topbar #moreMenu { z-index: 1201; }
/* Ensure dropdown buttons use regular palette, not the white-on-red topbar style */
.topbar #moreMenu { 
  position: absolute;
  top: 36px;
  right: 0;
  background: #fff;
  border: 1px solid rgba(0,0,0,0.08);
  border-radius: 12px;
  box-shadow: var(--shadow);
  padding: 6px;
  min-width: 220px;
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.topbar #moreMenu .btn { background: transparent; color: var(--ink); border: none; border-radius: 8px; padding: 10px 12px; justify-content: flex-start; width: 100%; margin: 0; font-size: 14px; font-weight: 500; transition: color .2s ease, background .2s ease; display: flex; align-items: center; gap: 10px; text-align: left; }
.topbar #moreMenu .btn:hover { background:#f9fafb; color: var(--brand-primary); }
.topbar #moreMenu .btn .icon { color: currentColor; flex-shrink: 0; width: 16px; height: 16px; }
.topbar #moreMenu .btn span { 
  font-weight: 500;
  letter-spacing: 0.01em;
  flex: 1;
}
.topbar #moreMenu hr { 
  border: none; 
  border-top: 1px solid rgba(0,0,0,0.06); 
  margin: 6px 0; 
  border-radius: 1px;
}
.topbar #docTitleGroup { position: absolute; left: 50%; transform: translateX(-50%); }
.topbar #docTitleGroup .btn { transition: background-color .15s ease, color .15s ease, border-color .15s ease; }
/* When renaming (input focused), switch to white pill + brand accent */
#docTitleGroup .btn:focus-within { background: #fff; color: var(--brand-primary); border-color: #fff; }
.btn { height: 26px; padding: 0 8px; border: 1px solid var(--border); border-radius: 8px; background: #fff; color: var(--ink); cursor: pointer; display: inline-flex; align-items: center; justify-content: center; gap: 6px; transition: border-color .15s, background .15s, color .15s; }
.btn:hover{ background: color-mix(in srgb, var(--primary) 8%, #fff); border-color: color-mix(in srgb, var(--primary) 20%, var(--border)); }
.btn.mini{ height: 22px; padding: 0 6px; font-size: 12px; }
.btn.mini:hover{ background: color-mix(in srgb, var(--primary) 8%, #fff); border-color: color-mix(in srgb, var(--primary) 20%, var(--border)); }
.btn.saving{ background: #fef3c7; border-color: #f59e0b; color: #92400e; }
.btn.saved{ background: #ecfdf5; border-color: #10b981; color: #065f46; }
.spacer { flex: 1; }
.topbar #docTitleGroup .btn { max-width: 420px; }
#docTitleText { max-width: 360px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
/* Title input inside red bar */
#docTitleInput { color:#fff; transition: background-color .15s ease, color .15s ease; }
#docTitleInput::placeholder { color: rgba(255,255,255,.8); }
/* Override inline styles while typing to ensure readability */
#docTitleInput:focus { background:#fff !important; color: var(--brand-dark) !important; }
#docTitleInput:focus::placeholder { color: rgba(0,0,0,.5) !important; }
/* Also recolor the title text on hover of the pill */
.topbar #docTitleGroup .btn:hover #docTitleInput,
.topbar #docTitleGroup .btn:focus-visible #docTitleInput { color: var(--brand-primary) !important; }
.topbar #version { font-size: 12px; color: var(--muted); display: flex; align-items: center; }
.pages-strip { display:flex; gap:6px; margin-right:8px; }
.pages-strip .page-tab { padding: 6px 10px; border:1px solid var(--border); border-radius: 8px; background:#fff; cursor:pointer; }
.pages-strip .page-tab.active { border-color: var(--primary); color: var(--primary); background:#eef2ff; }
.switch { display:inline-flex; align-items:center; gap:8px; font-size:14px; }

/* App layout */
.app { padding-top: calc(48px + 44px + 16px); display: grid; grid-template-columns: 1fr; gap: 12px; align-items: start; }
.side { background:#fff; border:1px solid var(--border); border-radius:10px; padding: 0; height: calc(100dvh - 96px); position: fixed; top: 64px; overflow:hidden; z-index: 1000; transition: width 0.3s ease, left 0.3s ease, right 0.3s ease; box-shadow: var(--shadow); }
.side.left { left:12px; width: var(--left-panel-width); }
.side.right { right:12px; width: var(--right-panel-width); }
.side.collapsed { width: 32px !important; }
.side.collapsed .panel-content { display: none; }
.side.collapsed .panel-header h3 { display: none; }
.side.left.collapsed ~ .workspace #pageViewport { padding-left: 44px; }
.side.right.collapsed ~ .workspace #pageViewport { padding-right: 44px; }

/* Panel structure */
.panel-header { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid var(--border); background: var(--brand-dark); border-radius: 10px 10px 0 0; }
.panel-header h3 { margin: 0; font-size: 14px; color: var(--brand-white); }
.panel-toggle { background: none; border: none; cursor: pointer; padding: 4px; color: var(--muted); font-size: 16px; border-radius: 4px; transition: background 0.15s ease, color 0.15s ease; }
.panel-toggle:hover { background: color-mix(in srgb, var(--primary) 8%, #fff); color: var(--primary); }
.panel-toggle .icon { display:block; width:16px; height:16px; transition: transform .15s ease; }
.panel-toggle[data-dir="right"] .icon { transform: rotate(180deg); }
.panel-content { padding: 10px; overflow-y: auto; height: calc(100% - 60px); }

/* Panel resize handles */
.panel-resize-handle { position: absolute; top: 0; bottom: 0; width: 4px; background: transparent; cursor: ew-resize; z-index: 1001; transition: background 0.15s ease; }
.panel-resize-handle:hover { background: var(--primary); }
.panel-resize-right { right: -2px; }
.panel-resize-left { left: -2px; }

.props { display:grid; grid-template-columns: 1fr; row-gap: 6px; font-size: 12px; }
.props .row { display: contents; }
.props .row > label { grid-column: 1 / -1; display:flex; align-items:center; color: var(--muted); font-size: 11px; margin-left: 2px; }
.props .row input:not([type="checkbox"]):not([type="radio"]), .props .row select, .props .row textarea { width: 100%; box-sizing: border-box; padding: 6px 8px; border:1px solid var(--border); border-radius:8px; font-size: 12px; height: 30px; transition: border-color .15s, background .15s; }
.props .row input:not([type="checkbox"]):not([type="radio"]):hover, .props .row select:hover, .props .row textarea:hover { border-color: color-mix(in srgb, var(--primary) 20%, var(--border)); background: color-mix(in srgb, var(--primary) 2%, #fff); }
.props .row input:not([type="checkbox"]):not([type="radio"]):focus, .props .row select:focus, .props .row textarea:focus { border-color: var(--primary); background: color-mix(in srgb, var(--primary) 4%, #fff); outline: none; }
.props .row input[type="checkbox"] { width: 16px; height: 16px; padding: 0; margin: 0; border-radius: 4px; }
.props .row textarea { height: 60px; resize: vertical; }
.props .row input[aria-invalid="true"]{ border-color:#ef4444; background:#fee2e2; }
.props .row .row-hint { grid-column: 1 / -1; font-size: 11px; color: var(--muted); }
.props .add-wrap { grid-column: 1 / -1; display:flex; justify-content:center; margin-top:6px; }
.props .add-wrap button { width:28px; height:28px; border-radius:8px; border:1px solid var(--border); background:#f9fafb; cursor:pointer; display:inline-flex; align-items:center; justify-content:center; }

/* Workspace and page */
.workspace { display: grid; grid-template-columns: 1fr; }
#pageViewport { height: calc(100dvh - 96px); overflow:auto; display:grid; place-items:start center; padding-left: calc(var(--left-panel-width) + 12px); padding-right: calc(var(--right-panel-width) + 12px); }
#pageContainer { padding: 12px; }
.page { position: relative; width: var(--page-w); height: var(--page-h); background:#fff; box-shadow: var(--shadow); overflow:hidden; border-radius:6px; transform: scale(var(--zoom)); transform-origin: top left; }
/* grid background removed per request (no ::before) */

/* Elements */
.element { position:absolute; box-sizing:border-box; outline:none; user-select:none; touch-action:none; }

/* Image elements */
.element.image { overflow:hidden; }
.element.image img { 
  width: 100%; 
  height: 100%; 
  object-fit: contain; 
  object-position: center;
  display: block;
}
/* .element.selected { box-shadow: inset 0 0 0 1.5px var(--primary); } */
.text { min-width:10px; min-height:10px; padding:6px 8px; border:1px solid var(--border); border-radius:4px; background:#fff; color:var(--ink); line-height:1.4; font-size:14pt; overflow:hidden; white-space:pre-wrap; word-break:break-word; }
/* NEW: make field look and behave like text */
.field {
  min-width:10px; min-height:10px; padding:6px 8px;
  border:1px solid var(--border); border-radius:4px;
  background:#fff; color:var(--ink); line-height:1.4; font-size:14pt;
  overflow:hidden; white-space:pre-wrap; word-break:break-word;
}

/* Allow caret & selection while editing */
.text.editing, .field.editing { cursor:text; user-select:text; }

/* Placeholder styling */
.text.has-placeholder, .field.has-placeholder { 
  color: #999; 
  font-style: italic; 
}

/* Table element */
.element.table { position:absolute; background:#fff; }

/* Grid host */
.table-grid {
  display:grid;
  width:100%; height:100%;
  user-select:none;           /* selection handled by app */
}

/* Cells */
.table-cell {
  display:flex;
  align-items:flex-start;     /* vertical alignment */
  justify-content:flex-start; /* horizontal alignment */
  padding:6px 8px;
  font-size:14pt; line-height:1.4;
  white-space:pre-wrap; word-break:break-word;
  /* outline removed; borders are set per-cell inline */
  background: transparent;
}

/* Editing */
.table-cell[contenteditable="true"] {
  cursor:text;
  user-select:text;
  outline-offset:-1px;
}

/* Focus ring for the active cell (roving tabindex) */
.table-cell:focus-visible { outline: none; }
/* Improve caret visibility while editing */
.table-cell[contenteditable="true"] {
  caret-color: currentColor;
}

/* Selection (cell/range): darken existing cell background without recoloring */
.table-cell.is-selected,
.table-cell.is-range    { background-image: none; }

/* Excel-like selection border overlay */
.table-selection {
  position:absolute;
  pointer-events:none;
  border:2px solid #059669;           /* emerald-600 */
  box-sizing: border-box;
  box-shadow: 0 0 0 1px rgba(5,150,105,.2) inset;
  border-radius: 2px;
  z-index: 1002;
}
.table-selection .handle {
  position:absolute; width:6px; height:6px;
  right:-4px; bottom:-4px;
  background:#059669; border:2px solid #fff; border-radius:2px;
  box-shadow: 0 0 0 1px #059669;
}

/* Outer border (draw once for crisp edges) */
.table-outer {
  pointer-events:none;
  position:absolute; inset:0;
  /* border:1px solid var(--table-outer, #000); */
}

/* Floating table actions bar */
/* removed .table-actions toolbar; replaced by context menu */

/* Table border drag affordances (shown on hover) */
.table-resizer {
  position:absolute; pointer-events:auto; z-index:1003;
  background: rgba(108,92,231,.55);
}
.table-resizer.v { width:2px; top:0; bottom:0; }
.table-resizer.h { height:2px; left:0; right:0; }
.table-grid.resizing { cursor: col-resize; }
.table-grid.resizing.row { cursor: row-resize; }
/* In view mode, force normal cursor inside tables */
.edit-off .table-grid, .edit-off .table-cell { cursor: default !important; }
.edit-off .table-grid.resizing, .edit-off .table-grid.resizing.row { cursor: default !important; }
.rect { border:1px solid var(--border); background:var(--brand-light); border-radius:6px; min-width:10px; min-height:10px; padding:6px 8px; line-height:1.4; overflow:hidden; white-space:pre-wrap; word-break:break-word; }
.line { height:2px; width:40px; background:#111827; transform-origin:0 0; }

/* Block container (stacked column) */
.element.block {
  background:#fff;
  border:1px solid var(--border);
  border-radius:8px;
  padding:8px;
}
.element.block > .element { position:absolute; }

/* Handles */
.handle { position:absolute; width:10px; height:10px; background:#fff; border:2px solid #10b981; border-radius:50%; box-shadow:0 1px 2px rgba(0,0,0,.1); pointer-events:all; }
.handle.corner { margin:-6px 0 0 -6px; }
.handle.tl{ top:0; left:0; } .handle.tr{ top:0; right:0; } .handle.bl{ bottom:0; left:0; } .handle.br{ bottom:0; right:0; }
.handle.endpoint { margin:-6px 0 0 -6px; z-index:5; }

/* Floating/format toolbar */
.floating { background:var(--panel); border:1px solid var(--border); border-radius:12px; box-shadow: var(--shadow); padding:6px; display:flex; flex-direction:row; gap:8px; z-index: 2000; }
.floating.hidden { display:none; }
.floating .row { display:flex; flex-wrap:nowrap; gap:12px; align-items:center; overflow-x:auto; white-space:nowrap; }
/* Align label text and controls vertically in toolbar */
.floating label { display:inline-flex; align-items:center; gap:6px; }
/* Fixed position for format toolbar under topbar */
#formatToolbar { position: fixed; top: 35px; left: 0; right: 0; margin: 4px auto 0; width: fit-content; z-index: 1100; }
/* Generic icon sizing for buttons */
.btn .icon { width:16px; height:16px; display:block; margin:auto; }

/* Layers and Brand kit (left panel) */
.layers { display:flex; flex-direction:column; gap:4px; font-size:12px; }
.layer-item { display:grid; grid-template-columns: auto 1fr auto auto; align-items:center; gap:6px; padding:4px 6px; border:1px solid var(--border); border-radius:6px; transition: background .15s ease, border-color .15s ease; }
.layer-item:hover { background: color-mix(in srgb, var(--primary) 4%, #fff); border-color: color-mix(in srgb, var(--primary) 20%, var(--border)); }
.layer-item .name { white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.brand-kit { display:flex; flex-direction:column; gap:8px; }
.brand-colors { display:grid; grid-template-columns: repeat(8, 1fr); gap:4px; }
.brand-color { width:18px; height:18px; border-radius:4px; border:1px solid var(--border); cursor:pointer; transition: border-color .15s ease; }
.brand-color:hover { border-color: var(--primary); }
.brand-fonts { display:flex; flex-wrap:wrap; gap:6px; }
.brand-font { padding:2px 6px; border:1px solid var(--border); border-radius:6px; cursor:pointer; font-size:12px; transition: background .15s ease, border-color .15s ease; }
.brand-font:hover { background: color-mix(in srgb, var(--primary) 4%, #fff); border-color: color-mix(in srgb, var(--primary) 20%, var(--border)); }

/* Pages list */
#pagesList { display: grid; gap: 32px; place-items: start center; width: 100%; }
.page-wrapper { display: grid; gap: 8px; justify-items: center; }
.page-title { color: var(--muted); font-size: 13px; display:flex; align-items:center; gap:6px; width: calc(var(--page-w) * var(--zoom)); }
.page-title .title-actions { margin-left: auto; float: none !important; }
.page-stage { position: relative; width: calc(var(--page-w) * var(--zoom)); height: calc(var(--page-h) * var(--zoom)); justify-self: center; }
.page-controls { display: inline-flex; gap: 6px; }

/* Element actions bubble */
#elementActions { position: fixed; transform: translate(-50%, -100%); background:var(--panel); border:1px solid var(--border); border-radius: 999px; box-shadow: var(--shadow); padding: 6px; display: inline-flex; gap: 6px; z-index: 900; transition: background .15s ease, border-color .15s ease; }
#elementActions.hidden { display: none; }
#elementActions:hover { background: color-mix(in srgb, var(--primary) 4%, #fff); border-color: color-mix(in srgb, var(--primary) 20%, var(--border)); }
#elementActions .menu { display: inline-flex; gap: 6px; }
#elementActions .dropdown.hidden { display: none; }
/* Compact icon menu inside actions dropdown */
#elementActions .dropdown .icon-row{ display:flex; gap:4px; align-items:center; justify-content:space-around; }
#elementActions .dropdown .group{ display:flex; flex-direction:column; gap:4px; }
#elementActions .dropdown .group-label{ font-size:11px; color:var(--muted); padding:0 2px; line-height:1; }
#elementActions .dropdown .btn.mini{ width:50%; height:26px; padding:0; display:inline-flex; align-items:center; justify-content:center; }

/* Floating table actions (small bubble) */
#tableActions { position: fixed; top: 72px; left: 0; right: 0; margin: 0 auto; transform: none; background:var(--panel); border:1px solid var(--border); border-radius: 12px; box-shadow: var(--shadow); padding: 6px; display: inline-flex; gap: 6px; z-index: 1150; width: fit-content; }
#tableActions.hidden { display: none; }

/* Alignment guides */
.guide { position: absolute; pointer-events: none; background: var(--primary); opacity: .8; z-index: 1500; }
.guide.v { width: 2px; height: 100%; top: 0; }
.guide.h { height: 2px; width: 100%; left: 0; }

/* generic hidden utility */
.hidden { display: none !important; }

/* Hub view */
.hub-header { position: fixed; left: 12px; right: 12px; top: 8px; height: 44px; background: var(--brand-primary); color: #fff; border-radius: 999px; display: flex; align-items: center; justify-content: space-between; padding: 0 10px 0 10px; box-shadow: var(--shadow); z-index: 1100; }
.hub-title { font-size: 12px; opacity: .95; }
.hub-save { background: var(--brand-dark); color:#fff; border-color: var(--brand-dark); }
/* Make hub header buttons visually match editor topbar pills */
.hub-header .btn { background: transparent; color: #fff; border-color: rgba(255,255,255,.9); border-radius: 999px; transition: background-color .15s ease, color .15s ease, border-color .15s ease, transform .15s ease; }
/* Match editor topbar prominent hover */
.hub-header .btn:hover,
.hub-header .btn:focus-visible { background:#fff; color: var(--brand-primary); border-color:#fff; transform: translateY(-1px); }
.hub-header .btn .icon { color: currentColor; }
.hub-header .btn .icon circle { fill: currentColor; }
.hub-header #hubMoreMenu { position:absolute; top:36px; right:0; background:#fff; border:1px solid rgba(0,0,0,0.08); border-radius:12px; box-shadow: var(--shadow); padding:6px; min-width:200px; display:flex; flex-direction:column; gap:4px; }
.hub-header #hubMoreMenu .btn { background:transparent; color:var(--ink); border:none; border-radius:8px; padding:10px 12px; justify-content:flex-start; width:100%; margin:0; font-size:14px; font-weight:500; transition: color .2s ease, background .2s ease; display:flex; align-items:center; gap:10px; text-align:left; }
.hub-header #hubMoreMenu .btn:hover { background:#f9fafb; color: var(--brand-primary); }
.hub-panel { position: fixed; top: 60px; bottom: 12px; left: 50px; right: 50px; background: var(--bg); display: grid; grid-template-rows: auto 1fr; padding: 8px; }
.hub-actions { display:flex; gap:8px; padding: 4px 6px 8px; align-items:center; flex-wrap:wrap; }
.doc-row.dragging { opacity:.6; }
/* Single global marker line shown between items while dragging (overlay, no reflow) */
.doc-drop-marker { position: absolute; left: 8px; right: 8px; top: 0; height: 0; border-top: 3px solid var(--primary); border-radius: 4px; pointer-events: none; z-index: 2; }
.doc-list { overflow: auto; padding-right: 4px; display: grid; gap: 10px; grid-auto-rows: min-content; position: relative; }
.doc-row { display:grid; grid-template-columns: 1fr auto; align-items:center; gap: 8px; background:var(--brand-white); border:1px solid var(--border); border-radius: 999px; padding: 8px 10px; transition: background-color .15s ease, border-color .15s ease, box-shadow .15s ease; }
.doc-row:hover { background: color-mix(in srgb, var(--primary) 6%, #f8fafc); border-color: color-mix(in srgb, var(--primary) 28%, var(--border)); box-shadow: 0 1px 2px rgba(0,0,0,.06); }
.doc-row:focus-within { background: color-mix(in srgb, var(--primary) 9%, #f8fafc); border-color: color-mix(in srgb, var(--primary) 38%, var(--border)); box-shadow: 0 0 0 2px color-mix(in srgb, var(--primary) 20%, transparent); }
.doc-name { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.doc-meta { font-size:12px; color: var(--muted); margin-right: 8px; }
.doc-actions { display:inline-flex; gap:6px; }
.doc-actions .btn { height: 24px; padding: 0 6px; }
body.in-hub .topbar, body.in-hub #formatToolbar, body.in-hub .side, body.in-hub .workspace { display: none !important; }

/* Inline rename input in hub list */
.doc-edit { width: auto; display:inline-block; box-sizing: border-box; border: 1px solid var(--border); border-radius: 8px; padding: 2px 6px; height: 24px; line-height: 20px; font-size: 14px; }
.doc-row.editing { background:#fff; border-color: var(--primary); box-shadow: 0 0 0 1px color-mix(in srgb, var(--primary) 20%, transparent); }

/* Folder bar (flat pills) */
#folderBar { position: relative; }
.folder-pill { display:inline-flex; align-items:center; gap:6px; height:28px; padding: 0 10px; border-radius: 999px; background: #f3f4f6; border: 1px solid var(--border); color: #111827; cursor: pointer; transition: background .12s ease, border-color .12s ease, color .12s ease, transform .12s ease; }
.folder-pill:hover, .folder-pill:focus-visible, .folder-pill.drag-over { background:#eef2ff; border-color: color-mix(in srgb, var(--primary) 35%, var(--border)); color: #1f2937; transform: translateY(-1px); }
.folder-pill.active { background:var(--brand-dark); border-color: var(--brand-dark); color: #fff; }
.folder-pill .icon { color: currentColor; }
.folder-pill .rename-input { height: 18px; border:1px solid var(--border); border-radius:6px; padding:0 6px; font-size:10px; background:#fff; color:var(--brand-dark); }
.folder-pill .close-btn { width:20px; height:20px; display:inline-flex; align-items:center; justify-content:center; border-radius:999px; background: transparent; border: none; color: inherit; }
.folder-pill .close-btn:hover { background: rgba(0,0,0,.08); }

.folder-plus { display:inline-flex; align-items:center; justify-content:center; width:28px; height:28px; border-radius:999px; border:1px dashed var(--border); background:var(--bg); color:#6b7280; cursor:pointer; }
.folder-plus:hover { background:#f3f4f6; color:#111827; border-style:solid; }
/* Drag-over highlight for folder drop */
/* .folder-pill.drag-over { outline: 2px solid var(--primary); outline-offset: 2px; background: #eef2ff; border-color: color-mix(in srgb, var(--primary) 45%, var(--border)); } */

/* Confirm dialog buttons */
#confirmDialog .btn.primary { background: var(--brand-primary); color:#fff; border-color: var(--brand-primary); }
#confirmDialog .btn.danger { background: #ef4444; color:#fff; border-color: #ef4444; }
#confirmDialog .btn.light { background: #f9fafb; }

/* Rulers */
.ruler { position:fixed; background:#fff; border:1px solid var(--border); z-index:1050; box-shadow:var(--shadow); }
.ruler.h { left:12px; right:12px; top:35px; height:20px; }
.ruler.v { top:64px; bottom:16px; left:12px; width:20px; }

/* Header/Footer guides (edit-mode only) */
.hf-guide { position:absolute; left:0; right:0; background: transparent; border:1px dashed rgba(59,130,246,.35); box-sizing: border-box; pointer-events: none; z-index: 50; }
.hf-guide.header { top:0; }
.hf-guide.footer { bottom:0; }
.hf-guide .hf-label { position:absolute; left:8px; top:6px; font-size:11px; color:#1f2937; background:transparent; padding:0; border-radius:0; border:none; pointer-events:none; }
.hf-guide .hf-label::after { content:''; }
.hf-guide.footer .hf-label { top:auto; bottom:6px; }
.hf-guide .hf-resize { position:absolute; left:0; right:0; height:8px; background: transparent; cursor: ns-resize; pointer-events: auto; }
.hf-guide.header .hf-resize { bottom:-4px; }
.hf-guide.footer .hf-resize { top:-4px; }
.element.repeated { pointer-events: none !important; }

/* Hide guides in view/export mode and PDF/export */
.edit-off .hf-guide { display: none !important; }
.__export_sandbox .hf-guide { display: none !important; }

/* circular color inputs */
input[type="color"].circle { appearance: none; -webkit-appearance: none; border: none; width: 24px; height: 24px; padding: 0; background: none; }
input[type="color"].circle::-webkit-color-swatch-wrapper { padding: 0; transition: border-color .15s ease; }
input[type="color"].circle::-webkit-color-swatch { border: 1px solid var(--border); border-radius: 999px; transition: border-color .15s ease; }
input[type="color"].circle:hover::-webkit-color-swatch { border-color: var(--primary); }

/* Custom Color Picker */
.custom-color-picker {
  position: fixed;
  background: white;
  border: 1px solid var(--border);
  border-radius: 12px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.12);
  padding: 12px;
  z-index: 2100;
  width: 260px; /* widened to fit recent colors comfortably */
}

.custom-color-picker.hidden {
  display: none;
}

.color-picker-section {
  margin-bottom: 12px;
}

.color-picker-section h4 {
  margin: 0 0 8px 0;
  font-size: 12px;
  font-weight: 600;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.color-history-grid {
  display: grid;
  grid-template-columns: repeat(10, 1fr); /* more columns for more chips */
  gap: 6px;
  margin-bottom: 12px;
}

.color-history-circle {
  width: 22px;
  height: 22px;
  border-radius: 50%;
  border: 2px solid transparent;
  cursor: pointer;
  transition: all 0.15s ease;
  position: relative;
}

.color-history-circle:hover {
  transform: scale(1.05);
  border-color: var(--primary);
}

.color-history-circle.selected {
  border-color: var(--primary);
}

.color-picker-input-wrapper {
  display: flex;
  align-items: center;
  gap: 8px;
}

.color-picker-input-wrapper input[type="color"] {
  width: 40px;
  height: 40px;
  border-radius: 8px;
  border: 1px solid var(--border);
  cursor: pointer;
}

.color-picker-hex {
  flex: 1;
  padding: 8px 12px;
  border: 1px solid var(--border);
  border-radius: 6px;
  font-family: 'Monaco', 'Menlo', monospace;
  font-size: 13px;
}

/* Toolbar toggle pressed state */
.btn[aria-pressed="true"] { background: color-mix(in srgb, var(--primary) 12%, #fff); border-color: var(--primary); color: var(--primary); }
.btn[aria-pressed="true"]:hover { background: color-mix(in srgb, var(--primary) 16%, #fff); border-color: color-mix(in srgb, var(--primary) 20%, var(--border)); }

/* Alignment hamburger icons (simple CSS drawing) */
/* Align buttons now use inline SVG; show only the active state group */
.align { position: relative; width: 28px; height: 28px; }
.align .icon { width: 16px; height: 16px; }
.align .h-icon, .align .v-icon { display: none; }
.align.h-left .h-icon.h-left { display: block; }
.align.h-center .h-icon.h-center { display: block; }
.align.h-right .h-icon.h-right { display: block; }
.align.v-top .v-icon.v-top { display: block; }
.align.v-middle .v-icon.v-middle { display: block; }
.align.v-bottom .v-icon.v-bottom { display: block; }

/* View mode: hide editing UI */
.edit-off #formatToolbar,
.edit-off #elementActions,
.edit-off #tableActions,
.edit-off .selbox,
.edit-off #lasso,
.edit-off .guide { display: none !important; }
.edit-off .page .element { cursor: default; }
.edit-off .page .element.selected { box-shadow: none; }
.edit-off .element.repeated { pointer-events: none; }
.edit-off .page-title .title-actions { visibility: hidden; }
.edit-off .side { display: none; }
.edit-off .app { grid-template-columns: 1fr; }
/* Export sandbox guard: ensure no transforms leak into the clone */
.__export_sandbox, .__export_sandbox * {
  transform: none !important;
}

/* Deterministic image boxes used by the editor */
.image-box {
  position: relative;
  display: flex;
  align-items: center;   /* vertical center (html2canvas-safe) */
  justify-content: center;
  overflow: hidden;
  box-sizing: border-box;  /* borders don't change content size */
}

/* Images on the canvas should behave the same in editor and export */
.canvas img,
.image-box img {
  display: block;           /* kill baseline alignment shifts */
  max-width: 100%;
  max-height: 100%;
  width: auto;
  height: auto;
  object-fit: contain;      /* don't crop */
  object-position: center;  /* center inside its box */
}

/* Background image boxes (alternative for maximum html2canvas reliability) */
.bg-image-box {
  background-repeat: no-repeat;
  background-position: center;
  background-size: contain;   /* or 'cover' if you want fill */
  box-sizing: border-box;
}

/* Not used. Styles are embedded in index.html for a single-file app per request. */



/* Disable text selection during drags/resizes */
body.app-noselect, body.app-noselect * { user-select: none !important; }
/* Hide complex controls from the simplified top bar (keep undo/redo visible) */
.topbar #viewToggles { display: none !important; }
/* Make undo/redo icon-only in the top bar */
.topbar #undoBtn span, .topbar #redoBtn span { display: none; }

/* Bottom-right floating zoom control */
.zoom-control { position: fixed; right: 12px; bottom: 12px; background: var(--panel); border:1px solid var(--border); border-radius: 999px; box-shadow: var(--shadow); padding: 6px 8px; display:inline-flex; align-items:center; gap:8px; z-index: 1200; transition: background .15s ease, border-color .15s ease; }
.zoom-control:hover { background: color-mix(in srgb, var(--primary) 4%, #fff); border-color: color-mix(in srgb, var(--primary) 20%, var(--border)); }
.zoom-control input[type="range"]{ width: 160px; transition: background .15s ease; }
.zoom-control input[type="range"]:hover { background: color-mix(in srgb, var(--primary) 2%, transparent); }
.zoom-control #zoomLabel { font-size: 12px; color: var(--ink); transition: color .15s ease; }
.zoom-control:hover #zoomLabel { color: var(--primary); }
